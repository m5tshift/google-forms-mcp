# Google Forms MCP

Google Forms MCP — это инструмент, который позволяет LLM управлять Google формами через Model Context Protocol (MCP).

## Возможности
- Получение списка всех форм пользователя
- Получение информации о конкретной форме по ID
- Создание новых форм
- Обновление существующих форм
- Закрытие форм для новых ответов
- Применение обновлений к элементам форм (вопросам, полям и т.д.)

## Зависимости
- `fastmcp` - библиотека для работы с MCP
- `google-api-python-client` - клиентская библиотека для API Google
- `google-auth`, `google-auth-httplib2`, `google-auth-oauthlib` - библиотеки для аутентификации с Google

## Настройка
1. Установите зависимости:

   uv:
      ```bash
      uv sync
      ```

   pip:
      ```bash
      pip install -r requirements.txt
      ```

2. Получите файл `credentials.json` с настройками OAuth 2.0 через [Google Cloud Console](https://console.cloud.google.com/):
   - Создайте новый проект или используйте существующий
   - Включите Google Forms API и Google Drive API
   - Создайте учетные данные OAuth 2.0 клиент веб-приложения
   - Скачайте JSON-файл и переименуйте его в `credentials.json`

3. Для тестирования импортов инструментов и получения token.json запустите MCP сервер:
   ```bash
   python server.py
   ```
   
   При первом запуске будет открыта веб-страница для аутентификации, и после успешного подключения будет создан файл `token.json` для хранения токенов доступа.

## Доступные инструменты

### `get_form(form_id)`
Получить всю информацию о форме по её ID — метаданные и элементы (вопросы/поля).
- Параметры: `form_id` (str) - идентификатор формы в Google Forms
- Возвращает: объект формы, содержащий её информацию, настройки, список вопросов (items) и пр.

### `list_forms()`
Получить список всех форм пользователя через Google Drive.
- Возвращает: массив объектов форм — каждый содержит минимум 'id' и 'name'

### `upsert_form(form_id, title, description)`
Создать новую форму или обновить существующую (по form_id).
- Параметры:
  - `form_id` (str, optional) - ID формы для обновления, либо None для создания новой
  - `title` (str) - заголовок формы
  - `description` (str, optional) - описание формы
- Возвращает: информацию о созданной/обновлённой форме

### `close_form(form_id)`
Закрыть форму для новых ответов — остановить приём новых submissions. После вызова форма останется, её структура сохранится, но новые ответы не будут приниматься.
- Параметры: `form_id` (str) - идентификатор формы, которую нужно "закрыть"
- Возвращает: обновлённые настройки формы

### `apply_questions_patch(form_id, requests)`
Применить набор операций (patch) к вопросам/элементам формы через batchUpdate.
Позволяет:
- добавлять/создавать вопросы/элементы (createItem)
- удалять элементы (deleteItem)
- перемещать элементы (moveItem)
- изменять существующие элементы (updateItem)
- любые комбинации одновременно — все операции будут применены в одной транзакции
- Параметры:
  - `form_id` (str) - ID формы
  - `requests` (List[dict]) - список операций в формате Google Forms API
- Возвращает: ответ API с обновлённой информацией

## Использование с Claude Desktop
Для использования MCP-сервера с Claude Desktop:
1. Убедитесь что mcp.run(...) в файле server.py установлен на `stdio`:
   ```python
   mcp.run(transport="stdio")
   ```
2. Настройте Claude Desktop для подключения к MCP-серверу:
Settings -> Developer -> Edit Config

   claude_desktop_config.json
   ```json
   {
      "mcpServers": {
         "GoogleFormsMCP": {
            "command": "uv",
            "args": [
            "--directory",
            "/Путь/к/директории/проекта/",
            "run",
            "server.py"
            ]
         }
      }
   }
   ```

## Авторизация
Приложение использует OAuth 2.0 для доступа к Google Forms API. При первом запуске будет открыт браузер для аутентификации пользователя. Токены хранятся в файле `token.json`.
